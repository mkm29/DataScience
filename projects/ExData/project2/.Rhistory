yearly.coal <- NEI.SCC %>% filter(Coal == TRUE) %>% group_by(year) %>% summarise(Total = sum(Emissions), Mean = mean(Emissions), Median = median(Emissions))
yLabel <- expression("PM"[2.5]*" emission in tons")
p1 <- ggplot(yearly.coal, aes(x = year, y = Total, fill=Coal, labesl = round(yearly.coal$Total,2))) +
geom_bar(stat = "identity") +
facet_grid(. ~ Coal) +
ylab(yLabel) +
ggtitle(expression("Total PM"[2.5]*" emissions in Baltimore, 199902998"))
p1$lab
p1 <- ggplot(yearly.coal, aes(x = year, y = Total, fill=Coal, labesl = round(yearly.coal$Total,2))) +
geom_bar(stat = "identity") +
ylab(yLabel) +
ggtitle(expression("Total PM"[2.5]*" emissions in Baltimore, 199902998"))
p1$labels$colour <- ""
p1
yearly.coal
yLabel <- expression("PM"[2.5]*" emission in kilotons")
p1 <- ggplot(yearly.coal, aes(x = year, y = Total/1000, labesl = round(yearly.coal$Total,2))/1000) +
geom_bar(stat = "identity") +
ylab(yLabel) +
ggtitle(expression("Total PM"[2.5]*" emissions in Baltimore, 1999-2008"))
p1
yLabel <- expression("PM"[2.5]*" emission in kilotons")
p1 <- ggplot(yearly.coal, aes(x = year, y = Total, labesl = round(yearly.coal$Total,2))) +
geom_bar(stat = "identity") +
ylab(yLabel) +
ggtitle(expression("Total PM"[2.5]*" emissions in Baltimore, 1999-2008"))
p1
yLabel <- expression("PM"[2.5]*" emission in kilotons")
p1 <- ggplot(yearly.coal, aes(x = year, y = Total/1000, label = round(yearly.coal$Total,2)/1000)) +
geom_bar(stat = "identity") +
ylab(yLabel) +
ggtitle(expression("Total PM"[2.5]*" emissions in Baltimore, 1999-2008"))
p1
library(RColorBrewer)
?colorRampPalette
x <- colorRampPalette(c("#FFFFD4", "#FED98E", "#FE9929", "#D95F0E", "#993404"))
x
x[1]
lOrBr <- c("#FFFFD4", "#FED98E", "#FE9929", "#D95F0E", "#993404")
filled.contour(volcano,
color.palette = colorRampPalette(YlOrBr, space = "Lab"),
asp = 1)
filled.contour(volcano,
color.palette = colorRampPalette(YlOrBr, space = "Lab",
bias = 0.5),
asp = 1)
## 'jet.colors' is "as in Matlab"
## (and hurting the eyes by over-saturation)
jet.colors <-
colorRampPalette(c("#00007F", "blue", "#007FFF", "cyan",
"#7FFF7F", "yellow", "#FF7F00", "red", "#7F0000"))
filled.contour(volcano, color = jet.colors, asp = 1)
YlOrBr <- c("#FFFFD4", "#FED98E", "#FE9929", "#D95F0E", "#993404")
filled.contour(volcano,
color.palette = colorRampPalette(YlOrBr, space = "Lab"),
asp = 1)
filled.contour(volcano,
color.palette = colorRampPalette(YlOrBr, space = "Lab",
bias = 0.5),
asp = 1)
## 'jet.colors' is "as in Matlab"
## (and hurting the eyes by over-saturation)
jet.colors <-
colorRampPalette(c("#00007F", "blue", "#007FFF", "cyan",
"#7FFF7F", "yellow", "#FF7F00", "red", "#7F0000"))
filled.contour(volcano, color = jet.colors, asp = 1)
jet.colors(1)
yLabel <- expression("PM"[2.5]*" emission in kilotons")
p1 <- ggplot(yearly.coal, aes(x = year, y = Total/1000, label = round(yearly.coal$Total,2)/1000), fill = jet.colors(4)) +
geom_bar(stat = "identity") +
ylab(yLabel) +
ggtitle(expression("Total PM"[2.5]*" emissions in Baltimore, 1999-2008"))
p1
p1 <- ggplot(yearly.coal, aes(x = year, y = Total/1000, label = round(yearly.coal$Total,2)/1000), fill = year) +
geom_bar(stat = "identity") +
ylab(yLabel) +
ggtitle(expression("Total PM"[2.5]*" emissions in Baltimore, 1999-2008"))
p1
p1 <- ggplot(yearly.coal, aes(x = year, y = Total/1000, label = round(yearly.coal$Total,2)/1000), fill = jet.colors(4)) +
geom_bar(stat = "identity") +
ylab(yLabel) +
ggtitle(expression("Total PM"[2.5]*" emissions in Baltimore, 1999-2008"))
p1
p1 <- ggplot(yearly.coal, aes(x = year, y = Total/1000, label = round(yearly.coal$Total,2)/1000), fill = as.factor(year)) +
geom_bar(stat = "identity") +
ylab(yLabel) +
ggtitle(expression("Total PM"[2.5]*" emissions in Baltimore, 1999-2008"))
p1
p1 <- ggplot(yearly.coal, aes(x = year, y = Total/1000, label = round(yearly.coal$Total,2)/1000), fill = c("red", "green", "purple", "blue")) +
geom_bar(stat = "identity") +
ylab(yLabel) +
ggtitle(expression("Total PM"[2.5]*" emissions in Baltimore, 1999-2008"))
p1
rm(p1)
par(mfrow = c(1,1)); plot.new;
p1 <- ggplot(yearly.coal, aes(x = year, y = Total/1000, label = round(yearly.coal$Total,2)/1000), fill = jet.colors(4)) +
geom_bar(stat = "identity") +
ylab(yLabel) +
ggtitle(expression("Total PM"[2.5]*" emissions in Baltimore, 1999-2008"))
p1
par(mfrow = c(1,1)); plot.new();
yearly.coal
par(mfrow = c(1,1)); plot.new();
p1 <- ggplot(yearly.coal, aes(x = year, y = Total/1000, label = round(yearly.coal$Total,2)/1000), fill = year) +
geom_bar(stat = "identity") +
ylab(yLabel) +
ggtitle(expression("Total PM"[2.5]*" emissions in Baltimore, 1999-2008"))
p1
p2 <- ggplot(yearly.coal, aes(year, Median)) +
geom_line(aes(col = as.factor(Coal))) +
scale_color_manual(labels = c("Non-coal", "Coal"), values = c("red", "blue")) +
ggtitle(expression("Median PM"[2.5]*" emission in kilotons, Baltimore 1999-2008"))
p2
yearly.coal2 <- NEI.SCC %>% filter(Coal2 == TRUE) %>% group_by(year) %>% summarise(Total = sum(Emissions), Mean = mean(Emissions), Median = median(Emissions))
par(mfrow = c(2,1)); plot.new();
p1 <- ggplot(yearly.coal, aes(x = year, y = Total/1000, label = round(yearly.coal$Total,2)/1000), fill = jet.colors(4)) +
geom_bar(stat = "identity") +
ylab(yLabel) +
ggtitle(expression("Total PM"[2.5]*" emission in kilotons, United States 1999-2008"))
p2 <- ggplot(yearly.coal2, aes(x = year, y = Total/1000, label = round(yearly.coal2$Total,2)/1000), fill = jet.colors(4)) +
geom_bar(stat = "identity") +
ylab(yLabel) +
ggtitle(expression("Total PM"[2.5]*" emission in kilotons, United States 1999-2008"))
plot.new()
grid.newpage()
grid.arrange(p1, p2)
#NEI.SCC$Coal2 <- with(NEI.SCC, grepl("[Cc]oal", EI.Sector, perl = T))
yearly.coal <- NEI.SCC %>% group_by(year) %>% summarise(Total = sum(Emissions), Mean = mean(Emissions), Median = median(Emissions))
#NEI.SCC$Coal2 <- with(NEI.SCC, grepl("[Cc]oal", EI.Sector, perl = T))
yearly <- NEI.SCC %>% group_by(year, Coal) %>% summarise(Total = sum(Emissions), Mean = mean(Emissions), Median = median(Emissions))
yearly.coal <- subset(yearly, Coal == TRUE)
p2 <- ggplot(yearly.coal, aes(x=year, y=Total/1000, labell = round(yearly.coal$Total,2)/1000, fill = jet.colors(4))) +
geom_line(aes(col = Coal)) +
ylab(yLabel)
p2
yearly.coal
p2 <- ggplot(yearly, aes(x=year, y=Total/1000, labell = round(yearly$Total,2)/1000, fill = jet.colors(4))) +
geom_line(aes(col = Coal)) +
ylab(yLabel)
p2
p2 <- ggplot(yearly, aes(x=year, y=Total/1000)) +
geom_line(aes(col = Coal)) +
ylab(yLabel)
p2
par(mfrow = c(2,1)); plot.new();
p1 <- ggplot(yearly.coal, aes(x = year, y = Total/1000, label = round(yearly.coal$Total,2)/1000), fill = jet.colors(4)) +
geom_bar(stat = "identity") +
ylab(yLabel) +
ggtitle(expression("Total PM"[2.5]*" emission in kilotons, United States 1999-2008"))
p2 <- ggplot(yearly, aes(x=year, y=Total/1000)) +
geom_line(aes(col = Coal)) +
ylab(yLabel)
p2
plot.new()
grid.newpage()
grid.arrange(p1, p2)
p1 <- ggplot(yearly.coal, aes(x = year, y = Total/1000, label = round(yearly.coal$Total,2)/1000), fill = jet.colors(4)) +
geom_bar(stat = "identity") +
ylab(yLabel) +
ggtitle(expression("Total PM"[2.5]*" emission in kilotons, United States 1999-2008"))
p2 <- ggplot(yearly, aes(x=year, y=Total/1000)) +
geom_line(aes(col = Coal)) +
ylab(yLabel)
plot.new()
grid.newpage()
grid.arrange(p1, p2)
getwd()
png(filename = "plot4.png", width = 1000, height = 800)
yearly.coal$Total <- with()
yLabel <- expression("Total PM"[2.5]*" emission in kilotons")
par(mfrow = c(2,1)); plot.new();
p1 <- ggplot(yearly.coal, aes(x = year, y = Total/1000, label = round(yearly.coal$Total,2)/1000), fill = jet.colors(4)) +
geom_bar(stat = "identity") +
ylab(yLabel) +
ggtitle(expression("Total PM"[2.5]*" emission in kilotons, United States 1999-2008"))
p2 <- ggplot(yearly, aes(x=year, y=Total/1000)) +
geom_line(aes(col = Coal)) +
ylab(yLabel)
plot.new()
grid.newpage()
grid.arrange(p1, p2)
dev.off()
baltimore.highway <- NEI.SCC %>% filter(Highway == TRUE) %>% group_by(year) %>% summarise(Total = sum(Emissions), Emissions = median(Emissions))
NEI.SCC$Highway <- with(NEI.SCC, grepl("[Hh]ighway", Short.Name, perl = T))
baltimore.highway <- NEI.SCC %>% filter(Highway == TRUE) %>% group_by(year) %>% summarise(Total = sum(Emissions), Emissions = median(Emissions))
plot(x=baltimore.highway$year, y = baltimore.highway$Emissions, xlab = "Year", ylab = "Emission Value", main = "Motor Vehicle Emissions, Baltimore 1999-2008", type = "l", lwd = 2, col = "blue")
yLabel <- expression("Total PM"[2.5]*" emission in kilotons")
par(mfrow = c(2,1)); plot.new();
yLabel <- expression("Total PM"[2.5]*" emission in kilotons")
plot(x=baltimore.highway$year, y = baltimore.highway$Total, xlab = "Year", ylab = yLabel, main = "Motor Vehicle Emissions, Baltimore 1999-2008", type = "l", lwd = 2, col = "blue")
par(new = TRUE)
baltimore.highway
p1 <- ggplot(baltimore.highway, aes(x = year, y = Total/1000, label = round(baltimore.highway$Total,2)/1000), fill = jet.colors(4)) +
geom_bar(stat = "identity") +
ylab(yLabel) +
ggtitle(expression("Total PM"[2.5]*" emission in kilotons, United States 1999-2008"))
p1
p1 <- ggplot(baltimore.highway, aes(x = year, y = Total/1000, label = round(baltimore.highway$Total,2)/1000), fill = jet.colors(4)) +
geom_bar(stat = "identity") +
ylab(yLabel) +
ggtitle(expression("Total PM"[2.5]*" emission in kilotons, United States 1999-2008")) +
geom_label(aes(fill = year),colour = "white", fontface = "bold")
p1
p1 <- ggplot(baltimore.highway, aes(x = year, y = Total/1000, label = round(baltimore.highway$Total,2)/1000), fill = jet.colors(4)) +
geom_bar(stat = "identity") +
ylab(yLabel) +
ggtitle(expression("Total PM"[2.5]*" emission in kilotons, United States 1999-2008"))
p1
p1 <- ggplot(baltimore.highway, aes(x = year, y = Total/1000, labels = round(baltimore.highway$Total,2)/1000), fill = jet.colors(4)) +
geom_bar(stat = "identity") +
ylab(yLabel) +
ggtitle(expression("Total PM"[2.5]*" emission in kilotons, United States 1999-2008"))
p1
round(baltimore.highway$Total,2)/1000)
round(baltimore.highway$Total,2)/1000
round(baltimore.highway$Total/1000,2)
rm(p1
)
plot.new()
par)mfrow=c(1,1)
par(mfrow=c(1,1)
p1 <- ggplot(baltimore.highway, aes(x = year, y = Total/1000, fill = year, labels = round(baltimore.highway$Total/1000,2))) +
geom_bar(stat = "identity") +
ylab(yLabel) +
ggtitle(expression("Total PM"[2.5]*" emission in kilotons, United States 1999-2008"))
p1
labels = round(baltimore.highway$Total/1000,2)
labels
p1 <- ggplot(baltimore.highway, aes(x = year, y = Total/1000, fill = year)) +
geom_bar(stat = "identity") +
ylab(yLabel) +
ggtitle(expression("Total PM"[2.5]*" emission in kilotons, United States 1999-2008"))
p1
baltimore.highway <- NEI.SCC %>% filter(Highway == TRUE & fips == "24510") %>% group_by(year) %>% summarise(Total = sum(Emissions), Emissions = median(Emissions))
p1 <- ggplot(baltimore.highway, aes(x = year, y = Total/1000, fill = year)) +
geom_bar(stat = "identity") +
ylab(yLabel) +
ggtitle(expression("Total PM"[2.5]*" emission in kilotons, United States 1999-2008"))
p1
p1 <- ggplot(baltimore.highway, aes(x = year, y = Total/1000, fill = year)) +
geom_bar(stat = "identity") +
ylab(yLabel) +
ggtitle(expression("Total PM"[2.5]*" emission in kilotons, Baltimore 1999-2008"))
p2 <- ggplot(baltimore.highway, aes(x=year, y=Total/1000)) +
geom_line(aes(col = Highway)) +
ylab(yLabel)
plot.new()
grid.newpage()
grid.arrange(p1, p2)
baltimore.highway
baltimore <- NEI.SCC %>% filter(fips == "24510") %>% group_by(year) %>% summarise(Total = sum(Emissions), Emissions = median(Emissions))
baltimore.highway <- subset(baltimore, Highway == TRUE)
baltimore <- NEI.SCC %>% filter(fips == "24510")
baltimore.highway <- subset(baltimore, Highway == TRUE)
baltimore <- baltimore %>% group_by(year) %>% summarise(Total = sum(Emissions), Emissions = median(Emissions))
p1 <- ggplot(baltimore.highway, aes(x = year, y = Total/1000, fill = year)) +
geom_bar(stat = "identity") +
ylab(yLabel) +
ggtitle(expression("Total PM"[2.5]*" emission in kilotons, Baltimore 1999-2008"))
p2 <- ggplot(baltimore, aes(x=year, y=Total/1000)) +
geom_line(aes(col = Highway)) +
ylab(yLabel)
plot.new()
grid.newpage()
grid.arrange(p1, p2)
baltimore.highway <- subset(baltimore, Highway == TRUE) %>% summarise(Total = sum(Emissions), Emissions = median(Emissions))
baltimore.highway <- subset(baltimore, Highway == TRUE)
baltimore <- NEI.SCC %>% filter(fips == "24510")
baltimore.highway <- subset(baltimore, Highway == TRUE)
head(baltimore.highway)
head(baltimore.highway$Highway, n = 100)
head(baltimore$Highway, n = 100)
baltimore <- baltimore %>% group_by(year) %>% summarise(Total = sum(Emissions), Emissions = median(Emissions))
baltimore
baltimore <- NEI.SCC %>% filter(fips == "24510")
baltimore.highway <- subset(baltimore, Highway == TRUE)
baltimore <- baltimore %>% group_by(year, Highway) %>% summarise(Total = sum(Emissions), Emissions = median(Emissions))
baltimore
p1 <- ggplot(baltimore.highway, aes(x = year, y = Total/1000, fill = year)) +
geom_bar(stat = "identity") +
ylab(yLabel) +
ggtitle(expression("Total PM"[2.5]*" emission in kilotons, Baltimore 1999-2008"))
p2 <- ggplot(baltimore, aes(x=year, y=Total/1000)) +
geom_line(aes(col = Highway)) +
ylab(yLabel)
plot.new()
grid.newpage()
grid.arrange(p1, p2)
p1 <- ggplot(baltimore.highway, aes(x = year, y = Total/1000, fill = year)) +
geom_bar(stat = "identity") +
ylab(yLabel) +
ggtitle(expression("Total PM"[2.5]*" emission in kilotons, Baltimore 1999-2008"))
p1
baltimore.highway <- subset(baltimore, Highway == TRUE)  %>% summarise(Total = sum(Emissions), Emissions = median(Emissions))
p1 <- ggplot(baltimore.highway, aes(x = year, y = Total/1000, fill = year)) +
geom_bar(stat = "identity") +
ylab(yLabel) +
ggtitle(expression("Total PM"[2.5]*" emission in kilotons, Baltimore 1999-2008"))
p1
yLabel <- expression("Total PM"[2.5]*" emission in tons")
p1 <- ggplot(baltimore.highway, aes(x = year, y = Total, fill = year)) +
geom_bar(stat = "identity") +
ylab(yLabel) +
ggtitle(expression("Total PM"[2.5]*" emission in kilotons, Baltimore 1999-2008"))
p1
p1 <- ggplot(baltimore.highway, aes(x = year, y = Total, fill = year)) +
geom_bar(stat = "identity") +
ylab(yLabel) +
ggtitle(expression("Total PM"[2.5]*" emission in kilotons, Baltimore 1999-2008"))
p2 <- ggplot(baltimore, aes(x=year, y=Total/1000)) +
geom_line(aes(col = Highway)) +
ylab(yLabel)
plot.new()
grid.newpage()
grid.arrange(p1, p2)
p2 <- ggplot(baltimore, aes(x=year, y=Total/1000)) +
geom_line(aes(col = Highway)) +
ylab(yLabel)
p2
p1 <- ggplot(baltimore.highway, aes(x = year, y = Total, fill = year)) +
geom_bar(stat = "identity") +
ylab(yLabel) +
ggtitle(expression("Total PM"[2.5]*" emission in kilotons, Baltimore 1999-2008"))
p2 <- ggplot(baltimore, aes(x=year, y=Total/1000)) +
geom_line(aes(col = Highway)) +
ylab(yLabel)
grid.newpage()
grid.arrange(p1, p2)
getwd()
png(filename = "plot5.png", width = 1000, height = 800)
par(mfrow = c(2,1)); plot.new();
yLabel <- expression("Total PM"[2.5]*" emission in tons")
p1 <- ggplot(baltimore.highway, aes(x = year, y = Total, fill = year)) +
geom_bar(stat = "identity") +
ylab(yLabel) +
ggtitle(expression("Total PM"[2.5]*" emission in kilotons, Baltimore 1999-2008"))
p2 <- ggplot(baltimore, aes(x=year, y=Total/1000)) +
geom_line(aes(col = Highway)) +
ylab(yLabel)
grid.newpage()
grid.arrange(p1, p2)
dev.off()
baltimore.highway <- subset(NEI.SCC, fips == "24510" & Highway == TRUE) %>% group_by(year) %>% summarise(Total = sum(Emissions), Emissions = median(Emissions))
la.highway = subset(NEI.SCC, fips == "06037" & Highway == TRUE) %>% group_by(Total = sum(Emissions), year) %>% summarise(Emissions = median(Emissions))
baltimore.highway
la.highway
la.highway = subset(NEI.SCC, fips == "06037" & Highway == TRUE) %>% group_by(year) %>% summarise(Total = sum(Emissions), Emissions = median(Emissions))
la.highway
baltimore.highway <- subset(NEI.SCC, fips == "24510" & Highway == TRUE) %>% group_by(year) %>% summarise(Total = sum(Emissions), Emissions = median(Emissions))
la.highway = subset(NEI.SCC, fips == "06037" & Highway == TRUE) %>% group_by(year) %>% summarise(Total = sum(Emissions), Emissions = median(Emissions))
baltimore.highway
la.highway
# we need to get the total's on the same scale for comparison plots
max(range(baltimore.highway$Total), range(la.highway$Total))
# we need to get the total's on the same scale for comparison plots
r <- c(0,max(range(baltimore.highway$Total), range(la.highway$Total)))
r
# we need to get the total's on the same scale for comparison plots
r <- c(0,max(range(baltimore.highway$Total), range(la.highway$Total))+500)
r
barplot(height = baltimore.highway$Total, names.arg = baltimore.highway$year, ylab = "Total PM2.5 Emissions in kilotons", main = "PM2.5 Emissions, United States 1999-2008", col = year, xlab = "Year", ylim = r)
barplot(height = baltimore.highway$Total, names.arg = baltimore.highway$year, ylab = "Total PM2.5 Emissions in kilotons", main = "PM2.5 Emissions, United States 1999-2008", col = c("green", "blue", "purple", "red"), xlab = "Year", ylim = r)
y <- rgb(jet.colors(4))
barplot(height = baltimore.highway$Total, names.arg = baltimore.highway$year, ylab = "Total PM2.5 Emissions in kilotons", main = "PM2.5 Emissions, United States 1999-2008", col = jet.colors(4), xlab = "Year", ylim = r)
yLabel <- expression("Total PM"[2.5]*" emission in tons")
colors <- jet.colors(4)
par(mfrow = c(2,1)); plot.new()
barplot(height = baltimore.highway$Total, names.arg = baltimore.highway$year, ylab = yLabel, main = expression("PM"[2.5]*" Emissions, United States 1999-2008"), col = "blue", xlab = "Year", ylim = r)
barplot(height = la.highway$Total, names.arg = la.highway$year, ylab = yLabel, xlab = "Year", col = "red", ylim = r)
par(mfrow = c(1,1)); plot.new()
barplot(height = baltimore.highway$Total, names.arg = baltimore.highway$year, ylab = yLabel, main = expression("PM"[2.5]*" Emissions, United States 1999-2008"), col = "blue", xlab = "Year", ylim = r)
par(mfrow = c(1,1)); plot.new()
barplot(height = baltimore.highway$Total, names.arg = baltimore.highway$year, ylab = yLabel, main = expression("PM"[2.5]*" Emissions, United States 1999-2008"), col = "blue", xlab = "Year", ylim = r)
par(new = TRUE)
barplot(height = la.highway$Total, names.arg = la.highway$year, ylab = yLabel, xlab = "Year", col = "red", ylim = r)
par(mfrow = c(1,1)); plot.new()
barplot(height = la.highway$Total, names.arg = la.highway$year, ylab = yLabel, xlab = "Year", col = "red", ylim = r)
par(new = TRUE)
barplot(height = baltimore.highway$Total, names.arg = baltimore.highway$year, ylab = yLabel, main = expression("PM"[2.5]*" Emissions, United States 1999-2008"), col = "blue", xlab = "Year", ylim = r)
legend("topright", legend = c("Los Angeles", "Baltimore"), lty = c(1,1), col = c("red", "blue"))
r2 <- c(min(range(baltimore.highway$Emissions, la.highway$Emissions)), max(range(baltimore.highway$Emissions), range(la.highway$Emissions)))
r2
par(mfrow = c(2,1)); plot.new()
barplot(height = la.highway$Total, names.arg = la.highway$year, ylab = yLabel, xlab = "Year", col = "red", ylim = r)
par(new = TRUE)
barplot(height = baltimore.highway$Total, names.arg = baltimore.highway$year, ylab = yLabel, main = expression("PM"[2.5]*" Emissions, United States 1999-2008"), col = "blue", xlab = "Year", ylim = r)
legend("topright", legend = c("Los Angeles", "Baltimore"), lty = c(1,1), col = c("red", "blue"))
r2 <- c(min(range(baltimore.highway$Emissions, la.highway$Emissions)), max(range(baltimore.highway$Emissions), range(la.highway$Emissions)))
plot(x=baltimore.highway$year, y=baltimore.highway$Emissions, xlab = "Year", ylab = "Emission Value", main = "Motor Vehicle Emissions, Baltimore vs. L.A.", ylim = r2, type = "l", lwd = 2, col = "blue")
par(new = TRUE)
plot(x=la.highway$year, y=la.highway$Emissions, xlab = "Year", ylab = "Emission Value", ylim = r2, col = "red", lwd = 2, lty = 2, type = "l")
par(mfrow = c(2,1)); plot.new()
barplot(height = la.highway$Total, names.arg = la.highway$year, ylab = yLabel, xlab = "Year", col = "red", ylim = r)
par(new = TRUE)
barplot(height = baltimore.highway$Total, names.arg = baltimore.highway$year, ylab = yLabel, main = expression("PM"[2.5]*" Emissions, United States 1999-2008"), col = "blue", xlab = "Year", ylim = r)
legend("topright", legend = c("Los Angeles", "Baltimore"), lty = c(1,1), col = c("red", "blue"))
r2 <- c(min(range(baltimore.highway$Emissions, la.highway$Emissions)), max(range(baltimore.highway$Emissions), range(la.highway$Emissions)))
plot(x=baltimore.highway$year, y=baltimore.highway$Emissions, xlab = "Year", ylab = "Emission Value", main = "Motor Vehicle Emissions, Baltimore vs. L.A.", ylim = r2, type = "l", lwd = 2, col = "blue")
par(new = TRUE)
plot(x=la.highway$year, y=la.highway$Emissions, xlab = "Year", ylab = "Emission Value", ylim = r2, col = "red", lwd = 2, lty = 2, type = "l")
legend("topright", legend = c("Los Angeles", "Baltimore"), lty = c(1,1), col = c("red", "blue"))
barplot(height = la.highway$Total, names.arg = la.highway$year, ylab = yLabel, xlab = "Year", col = "red", ylim = r)
par(new = TRUE)
barplot(height = baltimore.highway$Total, names.arg = baltimore.highway$year, ylab = yLabel, main = expression("PM"[2.5]*" Emissions, United States 1999-2008"), col = "blue", xlab = "Year", ylim = r)
legend("topright", legend = c("Los Angeles", "Baltimore"), lty = c(1,1), col = c("red", "blue"))
par(mfrow = c(2,1)); plot.new()
r2 <- c(min(range(baltimore.highway$Emissions, la.highway$Emissions)), max(range(baltimore.highway$Emissions), range(la.highway$Emissions)))
plot(x=baltimore.highway$year, y=baltimore.highway$Emissions, xlab = "Year", ylab = "Emission Value", main = "Motor Vehicle Emissions, Baltimore vs. L.A.", ylim = r2, type = "l", lwd = 2, col = "blue")
par(new = TRUE)
plot(x=la.highway$year, y=la.highway$Emissions, xlab = "Year", ylab = "Emission Value", ylim = r2, col = "red", lwd = 2, lty = 2, type = "l")
legend("topright", legend = c("Los Angeles", "Baltimore"), lty = c(1,1), col = c("red", "blue"))
barplot(height = la.highway$Total, names.arg = la.highway$year, ylab = yLabel, xlab = "Year", col = "red", ylim = r)
par(new = TRUE)
barplot(height = baltimore.highway$Total, names.arg = baltimore.highway$year, ylab = yLabel, main = expression("PM"[2.5]*" Emissions, United States 1999-2008"), col = "blue", xlab = "Year", ylim = r)
legend("topright", legend = c("Los Angeles", "Baltimore"), lty = c(1,1), col = c("red", "blue"))
library(data.table)
par(mfrow = c(2,1)); plot.new()
r2 <- c(min(range(baltimore.highway$Emissions, la.highway$Emissions)), max(range(baltimore.highway$Emissions), range(la.highway$Emissions)))
plot(x=baltimore.highway$year, y=baltimore.highway$Emissions, xlab = "Year", ylab = "Emission Value", main = "Motor Vehicle Emissions, Baltimore vs. L.A.", ylim = r2, type = "l", lwd = 2, col = "blue")
par(new = TRUE)
plot(x=la.highway$year, y=la.highway$Emissions, xlab = "Year", ylab = "Emission Value", ylim = r2, col = "red", lwd = 2, lty = 2, type = "l")
legend("topright", legend = c("Los Angeles", "Baltimore"), lty = c(1,1), col = c("red", "blue"))
plot.new()
barplot(height = la.highway$Total, names.arg = la.highway$year, ylab = yLabel, xlab = "Year", col = "red", ylim = r)
par(new = TRUE)
barplot(height = baltimore.highway$Total, names.arg = baltimore.highway$year, ylab = yLabel, main = expression("PM"[2.5]*" Emissions, United States 1999-2008"), col = "blue", xlab = "Year", ylim = r)
legend("topright", legend = c("Los Angeles", "Baltimore"), lty = c(1,1), col = c("red", "blue"))
par(mfrow = c(2,1)); plot.new()
r2 <- c(min(range(baltimore.highway$Emissions, la.highway$Emissions)), max(range(baltimore.highway$Emissions), range(la.highway$Emissions)))
plot(x=baltimore.highway$year, y=baltimore.highway$Emissions, xlab = "Year", ylab = "Emission Value", main = "Motor Vehicle Emissions, Baltimore vs. L.A.", ylim = r2, type = "l", lwd = 2, col = "blue")
par(new = TRUE)
plot(x=la.highway$year, y=la.highway$Emissions, xlab = "Year", ylab = "Emission Value", ylim = r2, col = "red", lwd = 2, lty = 2, type = "l")
legend("topright", legend = c("Los Angeles", "Baltimore"), lty = c(1,1), col = c("red", "blue"))
barplot(height = la.highway$Total, names.arg = la.highway$year, ylab = yLabel, xlab = "Year", col = "red", ylim = r)
par(new = TRUE)
barplot(height = baltimore.highway$Total, names.arg = baltimore.highway$year, ylab = yLabel, main = expression("PM"[2.5]*" Emissions, United States 1999-2008"), col = "blue", xlab = "Year", ylim = r)
legend("topright", legend = c("Los Angeles", "Baltimore"), lty = c(1,1), col = c("red", "blue"))
?plot
r2 <- c(min(range(baltimore.highway$Emissions, la.highway$Emissions)), max(range(baltimore.highway$Emissions), range(la.highway$Emissions)))
plot(x=baltimore.highway$year, y=baltimore.highway$Emissions, xlab = "Year", ylab = "Emission Value", main = "Motor Vehicle Emissions, Baltimore vs. L.A.", ylim = r2, type = "l", lwd = 2, col = "blue")
par(new = TRUE)
plot(x=la.highway$year, y=la.highway$Emissions, xlab = "Year", ylab = "Emission Value", ylim = r2, col = "red", lwd = 2, lty = 2, type = "l")
legend("topright", legend = c("Los Angeles", "Baltimore"), lty = c(1,1), col = c("red", "blue"))
par(new=FALSE)
barplot(height = la.highway$Total, names.arg = la.highway$year, ylab = yLabel, xlab = "Year", col = "red", ylim = r)
par(new = TRUE)
barplot(height = baltimore.highway$Total, names.arg = baltimore.highway$year, ylab = yLabel, main = expression("PM"[2.5]*" Emissions, United States 1999-2008"), col = "blue", xlab = "Year", ylim = r)
legend("topright", legend = c("Los Angeles", "Baltimore"), lty = c(1,1), col = c("red", "blue"))
par(mfrow = c(2,1)); plot.new()
r2 <- c(min(range(baltimore.highway$Emissions, la.highway$Emissions)), max(range(baltimore.highway$Emissions), range(la.highway$Emissions)))
plot(x=baltimore.highway$year, y=baltimore.highway$Emissions, xlab = "Year", ylab = "Emission Value", main = "Motor Vehicle Emissions, Baltimore vs. L.A.", ylim = r2, type = "l", lwd = 2, col = "blue")
par(new = TRUE)
plot(x=la.highway$year, y=la.highway$Emissions, xlab = "Year", ylab = "Emission Value", ylim = r2, col = "red", lwd = 2, lty = 2, type = "l")
legend("topright", legend = c("Los Angeles", "Baltimore"), lty = c(1,1), col = c("red", "blue"))
par(new=FALSE)
barplot(height = la.highway$Total, names.arg = la.highway$year, ylab = yLabel, xlab = "Year", col = "red", ylim = r)
par(new = TRUE)
barplot(height = baltimore.highway$Total, names.arg = baltimore.highway$year, ylab = yLabel, main = expression("PM"[2.5]*" Emissions, United States 1999-2008"), col = "blue", xlab = "Year", ylim = r)
legend("topright", legend = c("Los Angeles", "Baltimore"), lty = c(1,1), col = c("red", "blue"))
par(mfrow = c(1,1)); plot.new()
barplot(height = la.highway$Total, names.arg = la.highway$year, ylab = yLabel, xlab = "Year", col = "red", ylim = r)
par(new = TRUE)
barplot(height = baltimore.highway$Total, names.arg = baltimore.highway$year, ylab = yLabel, main = expression("PM"[2.5]*" Emissions, United States 1999-2008"), col = "blue", xlab = "Year", ylim = r)
legend("topright", legend = c("Los Angeles", "Baltimore"), lty = c(1,1), col = c("red", "blue"))
par(mfrow = c(1,1)); plot.new()
p1 <- barplot(height = la.highway$Total, names.arg = la.highway$year, ylab = yLabel, xlab = "Year", col = "red", ylim = r)
par(new = TRUE)
p2 <- barplot(height = baltimore.highway$Total, names.arg = baltimore.highway$year, ylab = yLabel, main = expression("PM"[2.5]*" Emissions, United States 1999-2008"), col = "blue", xlab = "Year", ylim = r)
legend("topright", legend = c("Los Angeles", "Baltimore"), lty = c(1,1), col = c("red", "blue"))
text(x = p1, y = la.highway$Total, labels = la.highway$Total, pos = 3)
text(x = p1, y = round(la.highway$Total,0), labels = round(la.highway$Total,0), pos = 3)
par(mfrow = c(1,1)); plot.new()
p1 <- barplot(height = la.highway$Total, names.arg = la.highway$year, ylab = yLabel, xlab = "Year", col = "red", ylim = r)
text(x = p1, y = round(la.highway$Total,0), labels = round(la.highway$Total,0), pos = 3)
par(new = TRUE)
p2 <- barplot(height = baltimore.highway$Total, names.arg = baltimore.highway$year, ylab = yLabel, main = expression("PM"[2.5]*" Emissions, United States 1999-2008"), col = "blue", xlab = "Year", ylim = r)
legend("topright", legend = c("Los Angeles", "Baltimore"), lty = c(1,1), col = c("red", "blue"))
text(x = p2, y = round(baltimore.highway$Total/1000,0), labels = round(baltimore.highway$Total/1000,0), pos = 3)
round(baltimore.highway$Total,0)
?text
par(mfrow = c(1,1)); plot.new()
p1 <- barplot(height = la.highway$Total, names.arg = la.highway$year, ylab = yLabel, xlab = "Year", col = "red", ylim = r)
text(x = p1, y = round(la.highway$Total,0), labels = round(la.highway$Total,0), pos = 3)
par(new = TRUE)
p2 <- barplot(height = baltimore.highway$Total, names.arg = baltimore.highway$year, ylab = yLabel, main = expression("PM"[2.5]*" Emissions, United States 1999-2008"), col = "blue", xlab = "Year", ylim = r)
legend("topright", legend = c("Los Angeles", "Baltimore"), lty = c(1,1), col = c("red", "blue"))
text(x = p2, y = round(baltimore.highway$Total,0)+100, labels = round(baltimore.highway$Total,0), pos = 3, col = "white")
par(mfrow = c(1,1), mar=c(5, 4, 4, 8) + 0.1); plot.new()
p1 <- barplot(height = la.highway$Total, names.arg = la.highway$year, ylab = yLabel, xlab = "Year", col = "red", ylim = r)
text(x = p1, y = round(la.highway$Total,0), labels = round(la.highway$Total,0), pos = 3)
par(new = TRUE)
p2 <- barplot(height = baltimore.highway$Total, names.arg = baltimore.highway$year, ylab = yLabel, main = expression("PM"[2.5]*" Emissions, United States 1999-2008"), col = "blue", xlab = "Year", ylim = r)
legend("topright", legend = c("Los Angeles", "Baltimore"), lty = c(1,1), col = c("red", "blue"))
text(x = p2, y = round(baltimore.highway$Total,0)+100, labels = round(baltimore.highway$Total,0), pos = 3, col = "white")
getwd()
png(filename = "plot6.png", width = 800, height = 600)
par(mfrow = c(1,1), mar=c(5, 4, 4, 8) + 0.1); plot.new()
p1 <- barplot(height = la.highway$Total, names.arg = la.highway$year, ylab = yLabel, xlab = "Year", col = "red", ylim = r)
text(x = p1, y = round(la.highway$Total,0), labels = round(la.highway$Total,0), pos = 3)
par(new = TRUE)
p2 <- barplot(height = baltimore.highway$Total, names.arg = baltimore.highway$year, ylab = yLabel, main = expression("PM"[2.5]*" Emissions, United States 1999-2008"), col = "blue", xlab = "Year", ylim = r)
legend("topright", legend = c("Los Angeles", "Baltimore"), lty = c(1,1), col = c("red", "blue"))
text(x = p2, y = round(baltimore.highway$Total,0)+100, labels = round(baltimore.highway$Total,0), pos = 3, col = "white")
dev.off()
p1 <- barplot(height = yearly$TotalEmissions/1000, names.arg = yearly$year, ylab = "Total PM2.5 Emissions in kilotons", main = "PM2.5 Emissions, United States 1999-2008", col = year, xlab = "Year", ylim = r)
text(x = p1, y = round(yearly$TotalEmissions/1000,0), labels = round(yearly$TotalEmissions/1000,0), pos = 3)
yearly <- NEI.SCC %>% group_by(year) %>% summarise(TotalEmissions = sum(Emissions), MeanEmissions = mean(Emissions), MedianEmissions = median(Emissions), Observations = n())
r <- c(0, 800+range(yearly$TotalEmissions)[2]/1000)
par(mfrow = c(1,1)); plot.new();
p1 <- barplot(height = yearly$TotalEmissions/1000, names.arg = yearly$year, ylab = "Total PM2.5 Emissions in kilotons", main = "PM2.5 Emissions, United States 1999-2008", col = year, xlab = "Year", ylim = r)
text(x = p1, y = round(yearly$TotalEmissions/1000,0), labels = round(yearly$TotalEmissions/1000,0), pos = 3)
?plot
